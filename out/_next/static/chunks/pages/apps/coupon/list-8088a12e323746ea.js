(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4269],{31425:function(e,t,i){"use strict";i.d(t,{Z:function(){return v}});var n=i(63366),o=i(87462),r=i(67294),a=i(86010),l=i(58510),s=i(90948),d=i(71657),c=i(1977),u=i(8027);function p(e){return(0,u.ZP)("MuiDialogActions",e)}(0,c.Z)("MuiDialogActions",["root","spacing"]);var m=i(85893);let g=["className","disableSpacing"],f=e=>{let{classes:t,disableSpacing:i}=e;return(0,l.Z)({root:["root",!i&&"spacing"]},p,t)},x=(0,s.ZP)("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:i}=e;return[t.root,!i.disableSpacing&&t.spacing]}})(({ownerState:e})=>(0,o.Z)({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto"},!e.disableSpacing&&{"& > :not(:first-of-type)":{marginLeft:8}})),h=r.forwardRef(function(e,t){let i=(0,d.Z)({props:e,name:"MuiDialogActions"}),{className:r,disableSpacing:l=!1}=i,s=(0,n.Z)(i,g),c=(0,o.Z)({},i,{disableSpacing:l}),u=f(c);return(0,m.jsx)(x,(0,o.Z)({className:(0,a.Z)(u.root,r),ownerState:c,ref:t},s))});var v=h},58951:function(e,t,i){"use strict";i.d(t,{Z:function(){return Z}});var n=i(63366),o=i(87462),r=i(67294),a=i(86010),l=i(58510),s=i(90948),d=i(71657),c=i(15861),u=i(1977),p=i(8027);function m(e){return(0,p.ZP)("MuiDialogContentText",e)}(0,u.Z)("MuiDialogContentText",["root"]);var g=i(85893);let f=["children","className"],x=e=>{let{classes:t}=e,i=(0,l.Z)({root:["root"]},m,t);return(0,o.Z)({},t,i)},h=(0,s.ZP)(c.Z,{shouldForwardProp:e=>(0,s.FO)(e)||"classes"===e,name:"MuiDialogContentText",slot:"Root",overridesResolver:(e,t)=>t.root})({}),v=r.forwardRef(function(e,t){let i=(0,d.Z)({props:e,name:"MuiDialogContentText"}),{className:r}=i,l=(0,n.Z)(i,f),s=x(l);return(0,g.jsx)(h,(0,o.Z)({component:"p",variant:"body1",color:"text.secondary",ref:t,ownerState:l,className:(0,a.Z)(s.root,r)},i,{classes:s}))});var Z=v},6514:function(e,t,i){"use strict";i.d(t,{Z:function(){return Z}});var n=i(63366),o=i(87462),r=i(67294),a=i(86010),l=i(58510),s=i(90948),d=i(71657),c=i(1977),u=i(8027);function p(e){return(0,u.ZP)("MuiDialogContent",e)}(0,c.Z)("MuiDialogContent",["root","dividers"]);var m=i(4472),g=i(85893);let f=["className","dividers"],x=e=>{let{classes:t,dividers:i}=e;return(0,l.Z)({root:["root",i&&"dividers"]},p,t)},h=(0,s.ZP)("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:i}=e;return[t.root,i.dividers&&t.dividers]}})(({theme:e,ownerState:t})=>(0,o.Z)({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px"},t.dividers?{padding:"16px 24px",borderTop:`1px solid ${(e.vars||e).palette.divider}`,borderBottom:`1px solid ${(e.vars||e).palette.divider}`}:{[`.${m.Z.root} + &`]:{paddingTop:0}})),v=r.forwardRef(function(e,t){let i=(0,d.Z)({props:e,name:"MuiDialogContent"}),{className:r,dividers:l=!1}=i,s=(0,n.Z)(i,f),c=(0,o.Z)({},i,{dividers:l}),u=x(c);return(0,g.jsx)(h,(0,o.Z)({className:(0,a.Z)(u.root,r),ownerState:c,ref:t},s))});var Z=v},37645:function(e,t,i){"use strict";var n=i(87462),o=i(63366),r=i(67294),a=i(86010),l=i(58510),s=i(15861),d=i(90948),c=i(71657),u=i(4472),p=i(34182),m=i(85893);let g=["className","id"],f=e=>{let{classes:t}=e;return(0,l.Z)({root:["root"]},u.a,t)},x=(0,d.ZP)(s.Z,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(e,t)=>t.root})({padding:"16px 24px",flex:"0 0 auto"}),h=r.forwardRef(function(e,t){let i=(0,c.Z)({props:e,name:"MuiDialogTitle"}),{className:l,id:s}=i,d=(0,o.Z)(i,g),u=f(i),{titleId:h=s}=r.useContext(p.Z);return(0,m.jsx)(x,(0,n.Z)({component:"h2",className:(0,a.Z)(u.root,l),ownerState:i,ref:t,variant:"h6",id:null!=s?s:h},d))});t.Z=h},4472:function(e,t,i){"use strict";i.d(t,{a:function(){return r}});var n=i(1977),o=i(8027);function r(e){return(0,o.ZP)("MuiDialogTitle",e)}let a=(0,n.Z)("MuiDialogTitle",["root"]);t.Z=a},86316:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/apps/coupon/list",function(){return i(92167)}])},3813:function(e,t,i){"use strict";i.d(t,{H:function(){return n}});let n={string:"text",email:"email",number:"number",date:"date","datetime-local":"datetime-local"}},92167:function(e,t,i){"use strict";let n;i.r(t),i.d(t,{default:function(){return W}});var o=i(85893),r=i(67294),a=i(87357),l=i(86886),s=i(66242),d=i(34386),c=i(18972),u=i(50135),p=i(93946),m=i(94054),g=i(18360),f=i(78818),x=i(63730),h=i(82229),v=i(11057),Z=i(50657),y=i(37645),j=i(6514),b=i(58951),w=i(5306),C=i(56815),D=i(31425),M=i(16310),P=i(87536),S=i(47533),q=i(3813),_=i(42298),O=i(11163),R=i(64529),A=i(782),N=i(55277),T=i(86501);let z="/coupan",E=(0,R.Ue)((0,A.$e)({coupon:{id:null,list:[],total:0,page:1,size:10,search:null,paginate:!0}},(e,t)=>({get:{list:async()=>{let{coupon:{page:i,size:n,search:o,paginate:r}}=t();T.ZP.promise(N.ZP.get(z,{query:{page:i,limit:n,search:o}}),{loading:"fetching...",success:t=>(console.log("res",t),e(e=>({coupon:{...e.coupon,list:null==t?void 0:t.data,total:null==t?void 0:t.data.total}})),(null==t?void 0:t.message)||"fetched"),error:e=>e})},paginate:t=>{let{page:i,size:o,search:r,paginate:a}=t;e(e=>({coupon:{...e.coupon,search:r||""}})),clearTimeout(n);let l=()=>{e(e=>({coupon:{...e.coupon,page:i||e.coupon.page,size:o||e.coupon.size,search:r||e.coupon.search,paginate:null==a||a}})),E.getState().get.list()};if(r){n=setTimeout(()=>{l()},1e3),e(e=>({coupon:{...e.coupon,search:r}}));return}l()}},select:t=>e(e=>({coupon:{...e.coupon,id:t}})),add:async e=>{let i=t().coupon.id,n=T.ZP.promise(i?N.ZP.put("".concat(z,"/").concat(i),e,{formData:!0}):N.ZP.post("".concat(z,"/register"),e,{formData:!1}),{loading:i?"Updating":"Adding",success:e=>(E.getState().get.paginate({}),null==e?void 0:e.message),error:e=>e});return n},delete:async()=>{let e=t().coupon.id;if(!e)return T.ZP.error("Please select a item");T.ZP.promise(N.ZP.del("".concat(z,"/").concat(e)),{loading:"deleting",success:e=>(E.getState().get.paginate({}),null==e?void 0:e.message),error:e=>e})}})));var I=i(84698);let k=e=>{var t;let{read:i,write:n,update:R,del:A}=e,N="Coupon",T={_id:M.Z_().nullable().meta({hidden:!0}),couponCode:M.Z_().required("Coupon code is required"),discount:M.Rx().min(1,"Discount must be greater than 0").required("Discount is required"),type:M.Z_().oneOf(["percentage","fixed"],"Invalid type").required("Discount type is required"),maxDiscountAmount:M.Rx().nullable(),expiryDate:M.hT().required("Expiry date is required").meta({type:"date"}),usageLimit:M.Rx().min(1,"Usage limit must be at least 1").required("Usage limit is required"),minPurchase:M.Rx().min(0,"Minimum purchase must be at least 0").required("Minimum purchase is required"),isActive:M.O7().default(!0).required(),isPublic:M.O7().default(!0).required(),firstTimeOnly:M.O7().default(!1).required(),applicableCourses:M.IX().of(M.Z_()).default([]),applicableCategory:M.Z_().required("Applicable category is required"),userLevel:M.Z_().required("User level is required"),maxEnrollments:M.Rx().min(1,"Max enrollments must be at least 1").required("Max enrollments is required"),description:M.Z_().required("Description is required"),autoApply:M.O7().default(!1).required(),isFeatured:M.O7().default(!1).required(),createdAt:M.hT().nullable().meta({hidden:!0}),updatedAt:M.hT().nullable().meta({hidden:!0})},z=M.Ry().shape(T),[k,W]=(0,r.useState)(!1),F=E(),[U,Y]=(0,r.useState)(z.getDefault()),[H,L]=(0,r.useState)(z.describe()),{control:X,handleSubmit:$,formState:{errors:G},getValues:V,setValue:B,reset:Q}=(0,P.cI)({defaultValues:U,mode:"onChange",resolver:(0,S.X)(z)});(0,r.useEffect)(()=>{F.get.paginate({size:10,page:1})},[]);let J=e=>{F.get.paginate({search:e})},K=async(e,t)=>{if(e)Y(z.getDefault()),L(z.describe()),Q(),F.select(null);else{let e=z.getDefault();for(let i in Y(e),L(z.describe()),e)B(i,t[i])}W(!0)},ee=()=>{W(!1)},et=[{field:"couponCode",headerName:"Coupon Code",minWidth:150,flex:.2},{field:"discount",headerName:"Discount",minWidth:120,flex:.15,valueGetter:e=>"percentage"===e.row.type?"".concat(e.row.discount,"%"):"â‚¹".concat(e.row.discount)},{field:"usageLimit",headerName:"Usage Limit",minWidth:100,flex:.1},{field:"usedCount",headerName:"Used",minWidth:80,flex:.1},{field:"isActive",headerName:"Active",minWidth:100,flex:.1,valueGetter:e=>e.row.isActive?"Yes":"No"},{flex:.1,minWidth:130,sortable:!1,field:"actions",headerName:"Actions",renderCell:e=>{let{row:t}=e;return(0,o.jsxs)(a.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,o.jsx)(d.Z,{title:"Edit ".concat(N),children:(0,o.jsx)(p.Z,{size:"small",onClick:()=>{for(let e in U)F.select(null==t?void 0:t.id),B(e,t[e]);K(!1,t)},children:(0,o.jsx)(x.Z,{icon:"mdi:edit-outline",fontSize:20})})}),(0,o.jsx)(d.Z,{title:"Delete ".concat(N),children:(0,o.jsx)(p.Z,{size:"small",onClick:()=>{F.select(null==t?void 0:t._id),F.delete()},children:(0,o.jsx)(x.Z,{icon:"mdi:delete-outline",fontSize:20})})})]})}}],ei=async e=>{await F.add(e),ee()};return(0,O.useRouter)(),(0,o.jsx)(h.Z,{children:(0,o.jsx)(l.ZP,{container:!0,spacing:6,children:(0,o.jsxs)(l.ZP,{item:!0,xs:12,children:[(0,o.jsxs)(s.Z,{children:[(0,o.jsxs)(a.Z,{sx:{p:5,pb:3,width:"100%",display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"space-between"},children:[(0,o.jsxs)(g.Z,{size:"small",displayEmpty:!0,defaultValue:"",sx:{mr:4,mb:2},disabled:!0,renderValue:e=>0===e.length?"Actions":e,children:[(0,o.jsx)(c.Z,{disabled:!0,children:"Actions"}),(0,o.jsx)(c.Z,{value:"Delete",children:"Delete"}),(0,o.jsx)(c.Z,{value:"Edit",children:"Edit"}),(0,o.jsx)(c.Z,{value:"Send",children:"Send"})]}),(0,o.jsxs)(a.Z,{sx:{display:"flex",flexWrap:"wrap",alignItems:"center"},children:[(0,o.jsx)(u.Z,{size:"small",sx:{mr:4,mb:2},placeholder:"Search ".concat(N),onChange:e=>J(e.target.value)}),(0,o.jsxs)(v.Z,{sx:{mb:2},variant:"contained",onClick:()=>{K(!0)},children:["Create ",N]})]})]}),(0,o.jsx)(f._,{autoHeight:!0,pagination:!0,rows:F.coupon.list,columns:et,getRowId:e=>e._id,disableRowSelectionOnClick:!0,pageSizeOptions:[10,25,50],paginationMode:"server",paginationModel:{page:F.coupon.page-1,pageSize:F.coupon.size},onPaginationModelChange:e=>{let{page:t,pageSize:i}=e;(t!=F.coupon.page-1||i!=F.coupon.size)&&F.get.paginate({page:t+1,size:i})},onColumnOrderChange:e=>{console.log("e: ",e)},rowCount:F.coupon.total})]}),(0,o.jsxs)(Z.Z,{open:k,onClose:ee,"aria-labelledby":"user-view-edit","aria-describedby":"user-view-edit-description",sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650}},children:[(0,o.jsxs)(y.Z,{id:"user-view-edit",sx:{textAlign:"center",fontSize:"1.5rem !important",px:e=>["".concat(e.spacing(5)," !important"),"".concat(e.spacing(15)," !important")],pt:e=>["".concat(e.spacing(8)," !important"),"".concat(e.spacing(12.5)," !important")]},children:[(null===(t=F.coupon)||void 0===t?void 0:t.id)?"Edit":"Add"," ",N]}),(0,o.jsxs)(j.Z,{sx:{pb:e=>"".concat(e.spacing(8)," !important"),px:e=>["".concat(e.spacing(5)," !important"),"".concat(e.spacing(15)," !important")]},children:[(0,o.jsx)(b.Z,{variant:"body2",id:"user-view-edit-description",sx:{textAlign:"center",mb:7}}),(0,o.jsx)("form",{onSubmit:$(ei),children:(0,o.jsx)(l.ZP,{container:!0,spacing:6,children:Object.keys(H.fields).map(e=>{var t,i,n,r;let a=H.fields[e];if(null==a?void 0:null===(t=a.meta)||void 0===t?void 0:t.hidden)return(0,o.jsx)(o.Fragment,{});let s=a.label;s||(s=(s=e.replaceAll("_"," ")).charAt(0).toUpperCase()+s.slice(1));let d=q.H[a.type];return(null===(i=a.meta)||void 0===i?void 0:i.type)==="file"&&(d=null===(r=a.meta)||void 0===r?void 0:r.type),"boolean"==a.type&&(a.oneOf=[{value:1,label:"YES"},{value:0,label:"NO"}]),(0,o.jsx)(l.ZP,{item:!0,xs:12,sm:12,children:(0,o.jsxs)(m.Z,{fullWidth:!0,children:[(0,o.jsx)(P.Qr,{name:e,control:X,rules:{required:!0},render:t=>{let{field:{value:i,onChange:n}}=t;try{if(a.oneOf.length)return(0,o.jsx)(w.Z,{options:[...a.oneOf],onChange:(t,i)=>{B(e,"object"==typeof i?null==i?void 0:i.value:i)},getOptionLabel:e=>"object"==typeof e?e.label:e,value:a.oneOf.find(e=>e.value==i)||i,renderInput:e=>(0,o.jsx)(u.Z,{...e,label:s})});if("file"==d){var r,l;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(v.Z,{variant:"outlined",fullWidth:!0,size:"large",color:"secondary",children:(0,o.jsxs)("label",{htmlFor:"user-view-".concat(e),style:{width:"100%",height:"100%",display:"flex",justifyContent:"start",alignItems:"center",cursor:"pointer"},children:[(0,o.jsx)(x.Z,{icon:"mdi:cloud-upload-outline"}),(0,o.jsx)("p",{style:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",margin:"0 0 0 5px"},children:(null==i?void 0:i.length)>0&&(null===(r=i[0])||void 0===r?void 0:r.name)||s})]})}),(0,o.jsx)("input",{type:"file",id:"user-view-".concat(e),hidden:!0,multiple:!0,onChange:t=>{let i=t.target.files;i&&(B(e,i),console.log(i))},...null==a?void 0:null===(l=a.meta)||void 0===l?void 0:l.attr})]})}if("date"===d)return(0,o.jsx)(I.t,{label:s,value:i,onChange:t=>{B(e,(0,_.default)(new Date(t),"yyyy-MM-dd HH:mm:ss"))}})}catch(t){return console.error(e),(0,o.jsx)(o.Fragment,{})}return(0,o.jsx)(u.Z,{value:i,label:s,onChange:"datetime-local"==d?t=>{B(e,(0,_.default)(new Date(t.target.value),"yyyy-MM-dd HH:mm:ss"))}:n,type:d,error:!!G[e]})}}),G[e]&&(0,o.jsx)(C.Z,{sx:{color:"error.main"},id:"validation-schema-first-name",children:null===(n=G[e])||void 0===n?void 0:n.message})]})})})})})]}),(0,o.jsxs)(D.Z,{sx:{justifyContent:"center",px:e=>["".concat(e.spacing(5)," !important"),"".concat(e.spacing(15)," !important")],pb:e=>["".concat(e.spacing(8)," !important"),"".concat(e.spacing(12.5)," !important")]},children:[(0,o.jsx)(v.Z,{variant:"contained",sx:{mr:2},onClick:$(ei),children:"Submit"}),(0,o.jsx)(v.Z,{variant:"outlined",color:"secondary",onClick:ee,children:"Cancel"})]})]})]})})})};k.moduleId=3,k.gameIds=[1,2];var W=k},84698:function(e,t,i){"use strict";i.d(t,{t:function(){return d}});var n=i(85893),o=i(9198),r=i.n(o),a=i(67294),l=i(82229),s=i(92313);let d=e=>{let{label:t,value:i,onChange:o}=e,[d,c]=(0,a.useState)(new Date);return(0,n.jsx)(l.Z,{children:(0,n.jsx)(r(),{showYearDropdown:!0,showMonthDropdown:!0,selected:d,dateFormat:"yyyy-MM-dd h:mm aa",showTimeInput:!0,placeholderText:"MM-DD-YYYY",value:i,onChange:(e,t)=>{c(e),o(e,t)},customInput:(0,n.jsx)(s.Z,{label:t,style:{width:"100%"}})})})}},92313:function(e,t,i){"use strict";var n=i(85893),o=i(67294),r=i(50135);let a=(0,o.forwardRef)((e,t)=>{let{...i}=e,{label:o,readOnly:a,style:l}=i;return(0,n.jsx)(r.Z,{inputRef:t,...i,...l&&{style:l},label:o||"",...a&&{inputProps:{readOnly:!0}}})});t.Z=a},459:function(){}},function(e){e.O(0,[4386,7536,2216,3863,9198,7693,8818,2229,9774,2888,179],function(){return e(e.s=86316)}),_N_E=e.O()}]);