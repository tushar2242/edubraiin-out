(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9179],{12507:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/apps/course/[id]/section",function(){return n(27007)}])},27007:function(e,t,n){"use strict";let i;n.r(t),n.d(t,{default:function(){return S}});var s=n(85893),c=n(87536),o=n(47533),l=n(87357),r=n(15861),a=n(90629),d=n(86886),u=n(50135),m=n(93946),x=n(11057),_=n(16310),h=n(63730),Z=n(64529),f=n(782),p=n(55277),j=n(86501);let g="/courses",v=(0,Z.Ue)((0,f.$e)({section:{id:null,list:[],total:0,page:1,size:10,search:null,paginate:!0,detail:{}}},(e,t)=>({get:{list:async()=>{let{section:{page:n,size:i,search:s,paginate:c}}=t();j.ZP.promise(p.ZP.get(g,{query:{page:n,limit:i,search:s}}),{loading:"fetching...",success:t=>(console.log("res",t),e(e=>({section:{...e.section,list:null==t?void 0:t.data.courses,total:null==t?void 0:t.data.total}})),(null==t?void 0:t.message)||"fetched"),error:e=>e})},paginate:t=>{let{page:n,size:s,search:c,paginate:o}=t;e(e=>({section:{...e.section,search:c||""}})),clearTimeout(i);let l=()=>{e(e=>({section:{...e.section,page:n||e.section.page,size:s||e.section.size,search:c||e.section.search,paginate:null==o||o}})),v.getState().get.list()};if(c){i=setTimeout(()=>{l()},1e3),e(e=>({section:{...e.section,search:c}}));return}l()}},select:t=>e(e=>({section:{...e.section,id:t}})),getdetails:t=>t?p.ZP.get("".concat(g,"/").concat(t)).then(t=>(e(e=>({section:{...e.section,detail:null==t?void 0:t.data.sections}})),null==t?void 0:t.data.sections)):j.ZP.error("No id selected "),add:async(e,t)=>{let n=j.ZP.promise(p.ZP.post("".concat(g,"/").concat(t),e,{formData:!0}),{loading:"Updating",success:e=>(v.getState().get.paginate({}),null==e?void 0:e.message),error:e=>e});return n},delete:async()=>{let e=t().section.id;if(!e)return j.ZP.error("Please select a item");j.ZP.promise(p.ZP.del("".concat(g,"/").concat(e)),{loading:"deleting",success:e=>(v.getState().get.paginate({}),null==e?void 0:e.message),error:e=>e})}})));var P=n(11163),y=n(67294);let b=_.Ry({sections:_.IX().of(_.Ry({section_no:_.Rx().required(),section_name:_.Z_().required(),section_lectures:_.IX().of(_.Ry({lecture_no:_.Rx().required(),lecture_name:_.Z_().required(),lecture_file_path:_.Z_().required()})).required()})).required()});function S(){let e=v(),{control:t,handleSubmit:n,reset:i}=(0,c.cI)({defaultValues:{sections:[{section_no:1,section_name:"",section_lectures:[{lecture_no:1,lecture_name:"",lecture_file_path:""}]}]},resolver:(0,o.X)(b)}),{fields:_,append:Z,remove:f}=(0,c.Dq)({control:t,name:"sections"}),p=(0,P.useRouter)(),{id:j}=p.query;async function g(){let t=await e.getdetails(j);t&&await i({sections:t})}(0,y.useEffect)(()=>{p.isReady&&g()},[p.isReady]);let S=t=>{e.add(t,j)};return(0,s.jsxs)(l.Z,{component:"form",onSubmit:n(S),noValidate:!0,children:[(0,s.jsx)(r.Z,{variant:"h5",mb:2,children:"Course Sections"}),_.map((e,n)=>(0,s.jsxs)(a.Z,{sx:{p:4,mb:3},children:[(0,s.jsxs)(d.ZP,{container:!0,spacing:2,alignItems:"center",children:[(0,s.jsx)(d.ZP,{item:!0,xs:2,children:(0,s.jsx)(c.Qr,{name:"sections.".concat(n,".section_no"),control:t,render:e=>{let{field:t}=e;return(0,s.jsx)(u.Z,{label:"Section No",type:"number",fullWidth:!0,...t})}})}),(0,s.jsx)(d.ZP,{item:!0,xs:8,children:(0,s.jsx)(c.Qr,{name:"sections.".concat(n,".section_name"),control:t,render:e=>{let{field:t}=e;return(0,s.jsx)(u.Z,{label:"Section Name",fullWidth:!0,...t})}})}),(0,s.jsx)(d.ZP,{item:!0,xs:2,children:(0,s.jsx)(m.Z,{onClick:()=>f(n),children:(0,s.jsx)(h.Z,{icon:"mdi:delete-outline",fontSize:20})})})]}),(0,s.jsx)(r.Z,{variant:"subtitle1",mt:2,children:"Lectures"}),(0,s.jsx)(q,{control:t,sectionIndex:n})]},e.id)),(0,s.jsxs)(x.Z,{startIcon:(0,s.jsx)(h.Z,{icon:"mdi:add-outline",fontSize:20}),onClick:()=>Z({section_no:null,section_name:"",section_lectures:[]}),variant:"outlined",sx:{mb:2},children:["Add Section",(0,s.jsx)(h.Z,{icon:"mdi:add-outline",fontSize:20})]}),(0,s.jsx)(l.Z,{mt:3,children:(0,s.jsx)(x.Z,{type:"submit",variant:"contained",children:"Submit"})})]})}function q(e){let{control:t,sectionIndex:n}=e,{fields:i,append:o,remove:a}=(0,c.Dq)({control:t,name:"sections.".concat(n,".section_lectures")});return(0,s.jsxs)(l.Z,{children:[i.map((e,i)=>(0,s.jsxs)(d.ZP,{container:!0,spacing:2,alignItems:"center",mt:1,children:[(0,s.jsx)(d.ZP,{item:!0,xs:1,children:(0,s.jsx)(c.Qr,{name:"sections.".concat(n,".section_lectures.").concat(i,".lecture_no"),control:t,render:e=>{let{field:t}=e;return(0,s.jsx)(u.Z,{label:"No",type:"number",fullWidth:!0,...t})}})}),(0,s.jsx)(d.ZP,{item:!0,xs:5,children:(0,s.jsx)(c.Qr,{name:"sections.".concat(n,".section_lectures.").concat(i,".lecture_name"),control:t,render:e=>{let{field:t}=e;return(0,s.jsx)(u.Z,{label:"Name",fullWidth:!0,...t})}})}),(0,s.jsx)(d.ZP,{item:!0,xs:5,children:(0,s.jsx)(c.Qr,{name:"sections.".concat(n,".section_lectures.").concat(i,".lecture_file_path"),control:t,render:e=>{let{field:{value:t,onChange:n}}=e;return(0,s.jsxs)(l.Z,{children:[(0,s.jsx)("input",{type:"file",accept:"video/*",onChange:e=>{var t;let i=null===(t=e.target.files)||void 0===t?void 0:t[0];n(i)}}),t&&"string"!=typeof t&&(0,s.jsx)(r.Z,{variant:"caption",children:t.name})]})}})}),(0,s.jsx)(d.ZP,{item:!0,xs:1,children:(0,s.jsx)(m.Z,{onClick:()=>a(i),children:(0,s.jsx)(h.Z,{icon:"mdi:delete-outline",fontSize:20})})})]},e.id)),(0,s.jsx)(x.Z,{startIcon:(0,s.jsx)(h.Z,{icon:"mdi:add-outline",fontSize:20}),onClick:()=>o({lecture_no:"",lecture_name:"",lecture_file_path:"",lecture_cloud_link:{_id:""}}),variant:"outlined",sx:{my:4},children:"Add Lecture"})]})}}},function(e){e.O(0,[7536,2216,9774,2888,179],function(){return e(e.s=12507)}),_N_E=e.O()}]);